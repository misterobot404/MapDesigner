(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{289:function(t,e,n){var i=n(304);"string"==typeof i&&(i=[[t.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(6)(i,r);i.locals&&(t.exports=i.locals)},297:function(t,e){t.exports="/images/no-image.png?cde74bf6643df8492c7ff3dd9271a77e"},303:function(t,e,n){"use strict";n(289)},304:function(t,e,n){(t.exports=n(5)(!1)).push([t.i,"[data-v-6b7cf79f] .youtube iframe {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  left: 0;\n  top: 0;\n}",""])},306:function(t,e,n){"use strict";var i=n(2),r=n.n(i),a=n(316),o=n(9);function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}r.a.use(a.a);var d={name:"MediaContent",props:{height:{type:String,required:!0}},data:function(){return{imgNotExist:[],videoPlaying:!1}},computed:l({},Object(o.c)("map",["selectedEvent","indexSelectedEvent"])),methods:l({},Object(o.b)("map",{deleteMedia:"deleteMedia"}))},u=(n(303),n(12)),v=n(13),p=n.n(v),f=n(53),m=n(395),h=n(396),b=n(66),_=n(70),g=n(275),y=n(18),E=Object(u.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-carousel",{attrs:{cycle:!t.videoPlaying,height:t.height,"show-arrows":t.selectedEvent.mediaUrl.length>1,"hide-delimiter-background":"","hide-delimiters":""}},[0!==t.selectedEvent.mediaUrl.length?t._l(t.selectedEvent.mediaUrl,(function(e,i){return n("v-carousel-item",{key:i},["constructor"===t.$route.name?n("v-btn",{staticClass:"v-btn--active",staticStyle:{right:"18px",top:"16px"},attrs:{fab:"","x-small":"",depressed:"",absolute:"",color:"grey"},on:{click:function(e){return t.deleteMedia({indexEvent:t.indexSelectedEvent,indexMediaUrl:i})}}},[n("v-icon",{attrs:{dark:""}},[t._v("clear")])],1):t._e(),t._v(" "),t.imgNotExist.includes(e)?e.indexOf("www.youtube.com")>-1?[n("youtube",{staticClass:"youtube",attrs:{"video-id":t.$youtube.getIdFromURL(e)},on:{playing:function(e){t.videoPlaying=!0},paused:function(e){t.videoPlaying=!1},ended:function(e){t.videoPlaying=!1}}})]:[n("div",{staticClass:"d-flex align-center fill-height"},[n("video",{attrs:{controls:"",width:"100%"},on:{play:function(e){t.videoPlaying=!0},pause:function(e){t.videoPlaying=!1}}},[n("source",{attrs:{src:e,type:"video/mp4"}})])])]:[n("v-img",{attrs:{height:"100%",contain:"",src:e},on:{error:function(n){return t.imgNotExist.push(e)}}})]],2)})):n("v-carousel-item",[n("v-sheet",{attrs:{color:"primary",height:"100%"}},[n("v-row",{staticClass:"fill-height",attrs:{align:"center",justify:"center"}},[n("div",{staticClass:"display-1"},[t._v("Контент")])])],1)],1)],2)}),[],!1,null,"6b7cf79f",null);e.a=E.exports;p()(E,{VBtn:f.a,VCarousel:m.a,VCarouselItem:h.a,VIcon:b.a,VImg:_.a,VRow:g.a,VSheet:y.a})},312:function(t,e,n){var i=n(359);"string"==typeof i&&(i=[[t.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(6)(i,r);i.locals&&(t.exports=i.locals)},317:function(t,e,n){var i=n(371);"string"==typeof i&&(i=[[t.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(6)(i,r);i.locals&&(t.exports=i.locals)},319:function(t,e,n){var i=n(378);"string"==typeof i&&(i=[[t.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(6)(i,r);i.locals&&(t.exports=i.locals)},349:function(t,e){t.exports="/images/help_part_1.gif?a94e5bb01144108f20df894607afafe0"},350:function(t,e){t.exports="/images/help_part_2.gif?e6bf7ca041fa2c810fcdb40b0bb584d1"},351:function(t,e){t.exports="/images/help_part_3.gif?b9b2ceb41681cec3c584f3a199201016"},352:function(t,e){t.exports="/images/help_part_4.gif?9a09b600a3ce8d951181085b06487167"},353:function(t,e){t.exports="/images/help_part_5.gif?03a08737f79d97d802b00b112d478ffd"},354:function(t,e){t.exports="/images/help_part_6.gif?116fa5951a358c57cde019c050fe97e6"},358:function(t,e,n){"use strict";n(312)},359:function(t,e,n){(t.exports=n(5)(!1)).push([t.i,"[data-v-7dcb135a] .v-btn__content {\n  display: inline-block;\n  max-width: 100%;\n  max-height: 60px;\n  text-align: center;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n#eventList[data-v-7dcb135a] {\n  max-width: 50%;\n  min-width: 160px;\n  overflow-y: scroll;\n  overflow-x: hidden;\n  resize: horizontal;\n}\n.eventDraggable[data-v-7dcb135a] {\n  pointer-events: auto !important;\n  cursor: -webkit-grab !important;\n  cursor: grab !important;\n}",""])},370:function(t,e,n){"use strict";n(317)},371:function(t,e,n){(t.exports=n(5)(!1)).push([t.i,"[data-v-2c2ff232] .border-color-gray:not(.v-input--is-focused) .v-input__control > .v-input__slot fieldset {\n  color: rgba(0, 0, 0, 0.2) !important;\n}",""])},377:function(t,e,n){"use strict";n(319)},378:function(t,e,n){(t.exports=n(5)(!1)).push([t.i,".map[data-v-54dca508] {\n  width: 100%;\n  margin: auto;\n  border: 1px solid #4d565661;\n}",""])},405:function(t,e,n){"use strict";n.r(e);var i=n(30),r=n.n(i),a=n(27),o=n(9);function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d={name:"CreateMapDialog",data:function(){return{dialog:!1,loading:!1,loadingSharedTile:!1,sharedTileIndex:null,name:"",tileUrl:"",tileImage:null}},computed:l(l({},Object(o.e)("tiles",["tiles","sharedTiles"])),Object(o.c)("auth",["isAuth"])),methods:l(l(l({},Object(o.d)("layout",["SHOW_MSG_DIALOG"])),Object(o.b)("tiles",["createTile"])),{},{l_createSharedTile:function(t,e){var n=this;this.loadingSharedTile=!0,this.sharedTileIndex=e,this.createTile(t).then((function(t){return n.SHOW_MSG_DIALOG({show:!0,text:"Подложка добавлена!"})})).finally((function(){n.loadingSharedTile=!1,n.sharedTileIndex=null}))},l_createTile:function(){var t=this;this.loading=!0;var e={name:this.name,url:this.tileUrl,image:this.tileImage};this.createTile(e).then((function(e){t.SHOW_MSG_DIALOG({show:!0,text:"Подложка добавлена!"}),t.name="",t.tileUrl="",t.tileImage=null})).finally((function(){return t.loading=!1}))}})},u=n(12),v=n(13),p=n.n(v),f=n(53),m=n(85),h=n(14),b=n(273),_=n(282),g=n(276),y=n(80),E=n(17),O=n(329),x=n(274),T=n(309),S=n(66),w=n(70),C=n(55),j=n(15),I=n(87),V=n(275),P=n(263),D=n(277),k=n(90),L=n(26),M=n(24),A=n(45),N=Object(u.a)(d,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-dialog",{attrs:{"max-width":"800","hide-overlay":"",scrollable:"",transition:"fade-transition"},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[i("v-btn",t._g({staticClass:"mt-4 v-btn--active",attrs:{disabled:!t.isAuth,depressed:"",color:"primary"}},n),[t._v("\n            Добавить подложку\n        ")])]}}]),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[t._v(" "),i("v-card",{attrs:{height:"575",loading:t.loading}},[i("v-toolbar",{staticClass:"pr-1",attrs:{height:"68",flat:""}},[i("v-btn",{attrs:{icon:""},on:{click:function(e){t.dialog=!1}}},[i("v-icon",[t._v("arrow_back")])],1),t._v(" "),i("v-icon",{staticClass:"mx-2",attrs:{large:"",color:"primary"}},[t._v("\n                layers\n            ")]),t._v(" "),i("v-toolbar-title",[t._v(" Добавление подложки")])],1),t._v(" "),i("v-divider"),t._v(" "),i("v-card-text",{staticClass:"pa-0"},[i("v-form",{ref:"form"},[i("v-card-text",[i("v-row",{attrs:{"no-gutters":""}},[i("v-col",[i("v-form",{ref:"form"},[i("v-container",{staticClass:"py-0"},[i("v-subheader",[t._v("Создание")]),t._v(" "),i("div",{staticClass:"d-flex flex-column pt-2"},[i("div",{staticClass:"d-flex pb-0"},[i("v-col",{staticClass:"pb-0",attrs:{cols:"6"}},[i("v-text-field",{attrs:{label:"Название",filled:"",rules:[function(e){return void 0===t.tiles.find((function(t){return t.name===e}))||"Подложка с таким названием уже существует"}],required:""},model:{value:t.name,callback:function(e){t.name="string"==typeof e?e.trim():e},expression:"name"}})],1),t._v(" "),i("v-col",{staticClass:"pb-0",attrs:{cols:"6"}},[i("v-select",{attrs:{filled:"",items:["Фреймы","Растяжение","Дублирование"],value:"Фреймы",label:"Вид отображения",required:""}})],1)],1),t._v(" "),i("v-col",{staticClass:"pt-2",attrs:{cols:"12"}},[i("div",{staticClass:"d-flex"},[i("v-text-field",{staticStyle:{"flex-basis":"200px"},attrs:{disabled:null!==t.tileImage,label:"Ссылка на картинку / подложку",filled:"",rules:[function(e){return void 0===t.tiles.find((function(t){return t.name===e}))||"Такое название уже используется"},function(e){return void 0===t.tiles.find((function(t){return t.url===e}))||"Подложка с такой ссылкой уже используется"}],required:""},model:{value:t.tileUrl,callback:function(e){t.tileUrl="string"==typeof e?e.trim():e},expression:"tileUrl"}}),t._v(" "),i("span",{staticClass:"flex-grow-0 mx-3 pt-5"},[t._v(" или ")]),t._v(" "),i("v-file-input",{staticStyle:{"flex-basis":"200px"},attrs:{disabled:""!==t.tileUrl,label:"Загрузка с компьютера",accept:"image/*",outlined:""},model:{value:t.tileImage,callback:function(e){t.tileImage=e},expression:"tileImage"}})],1),t._v(" "),i("v-row",{attrs:{"no-gutters":"",align:"center"}},[i("a",{staticClass:"text-decoration-none",attrs:{href:"http://leaflet-extras.github.io/leaflet-providers/preview/index.html",target:"_blank"}},[t._v("\n                                                    Внешняя библиотека подложек.\n                                                ")]),t._v(" "),i("v-spacer"),t._v(" "),i("v-btn",{staticClass:"px-7",attrs:{loading:t.loading,color:"primary",outlined:""},on:{click:t.l_createTile}},[t._v("\n                                                    Добавить\n                                                ")])],1)],1)],1)],1)],1)],1)],1),t._v(" "),i("v-divider",{staticClass:"mx-2 my-6"}),t._v(" "),i("v-row",[i("v-col",[i("v-container",{staticClass:"py-0"},[i("v-subheader",[t._v("Подложки от разработчиков")]),t._v(" "),i("v-row",{staticClass:"pt-3",attrs:{justify:"center"}},t._l(t.sharedTiles,(function(e,r){return i("v-hover",{key:e.id,scopedSlots:t._u([{key:"default",fn:function(a){var o=a.hover;return[i("v-card",{staticClass:"ma-5 align-self-start",attrs:{"max-width":t.$vuetify.breakpoint.xl?"180":"100",loading:t.loadingSharedTile&&t.sharedTileIndex===r}},[i("v-img",{attrs:{src:n(297)},on:{click:function(e){return t.$router.push({path:"/viewer/"+t.map.id})}}}),t._v(" "),i("v-list-item",[i("v-list-item-content",[i("v-list-item-title",[t._v(t._s(e.name))])],1)],1),t._v(" "),i("v-fade-transition",[o?i("v-overlay",{attrs:{absolute:"",color:"primary",opacity:"0.2"}},[t.loadingSharedTile?t._e():i("v-btn",{on:{click:function(n){return t.l_createSharedTile(e,r)}}},[t._v("\n                                                        Добавить\n                                                    ")])],1):t._e()],1)],1)]}}],null,!0)})})),1)],1)],1)],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null),U=N.exports;function R(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function F(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?R(Object(n),!0).forEach((function(e){W(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function W(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}p()(N,{VBtn:f.a,VCard:m.a,VCardText:h.c,VCol:b.a,VContainer:_.a,VDialog:g.a,VDivider:y.a,VFadeTransition:E.d,VFileInput:O.a,VForm:x.a,VHover:T.a,VIcon:S.a,VImg:w.a,VListItem:C.a,VListItemContent:j.a,VListItemTitle:j.c,VOverlay:I.a,VRow:V.a,VSelect:P.a,VSpacer:D.a,VSubheader:k.a,VTextField:L.a,VToolbar:M.a,VToolbarTitle:A.a});var H={name:"Settings",components:{AddTileDialog:U},data:function(){return{dialog:!1,deletedTileId:[]}},computed:F(F(F(F(F({},Object(o.e)("map",["name","description","subject_id","tile_id","config"])),Object(o.e)({maps:function(t){return t.maps.maps},tiles:function(t){return t.tiles.tiles},sharedTiles:function(t){return t.tiles.sharedTiles},subjects:function(t){return t.subjects.subjects}})),Object(o.c)("auth",["isAuth"])),Object(o.c)("tiles",["selectedTile"])),{},{m_name:{get:function(){return this.name},set:function(t){this.SET_MAP_NAME(t)}},m_description:{get:function(){return this.description},set:function(t){this.SET_MAP_DESCRIPTION(t)}},m_subjectId:{get:function(){return this.subject_id},set:function(t){this.SET_MAP_SUBJECT_ID(t)}},m_tileId:{get:function(){return this.tile_id},set:function(t){this.SET_TILE_ID(t),this.SET_TILE_FOR_CREATE(this.selectedTile)}},m_minZoom:{get:function(){return this.config.minZoom},set:function(t){t&&t>=0&&t<=this.config.maxZoom&&this.SET_MIN_TILE_ZOOM(parseInt(t))}},m_maxZoom:{get:function(){return this.config.maxZoom},set:function(t){t&&t>=0&&t>=this.config.minZoom&&this.SET_MAX_TILE_ZOOM(parseInt(t))}},m_polylineWeight:{get:function(){return void 0===this.config.polylineWeight?2:this.config.polylineWeight},set:function(t){this.SET_POLYLINE_WEIGHT(t)}},m_showPolyline:{get:function(){return this.config.showPolyline},set:function(t){this.SET_SHOW_POLYLINE(t)}}}),methods:F(F(F(F({},Object(o.d)("layout",["CHANGE_THEME","SHOW_MSG_DIALOG"])),Object(o.d)("map",["SET_SHOW_POLYLINE","SET_POLYLINE_WEIGHT","SET_MIN_TILE_ZOOM","SET_MAX_TILE_ZOOM","SET_MAP_NAME","SET_MAP_DESCRIPTION","SET_MAP_SUBJECT_ID","SET_TILE_ID","SET_TILE_FOR_CREATE"])),Object(o.b)("tiles",["deleteTile"])),{},{lDeleteTile:function(t){var e=this;this.maps.find((function(e){return e.tile_id===t}))?this.SHOW_MSG_DIALOG({show:!0,text:"Подложка используется!"}):(this.deletedTileId.push(t),this.deleteTile(t).finally((function(){var n=e.deletedTileId.findIndex((function(e){return e===t}));e.deletedTileId.splice(n,1)})))}})},Z=n(54),B=n(389),G=n(272),z=n(279),$=Object(u.a)(H,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-dialog",{attrs:{"max-width":"800",scrollable:"",transition:"dialog-bottom-transition"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[n("v-btn",t._g({staticClass:"mx-2",attrs:{height:"40"},on:{click:function(e){t.dialog=!0}}},i),[n("v-icon",{staticClass:"mr-1",staticStyle:{opacity:"0.76"}},[t._v(" settings")]),t._v("\n            Настройки\n        ")],1)]}}]),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[t._v(" "),n("v-card",[n("v-toolbar",{staticClass:"pr-1",attrs:{height:"68",flat:""}},[n("v-icon",{staticClass:"mr-2",attrs:{large:""}},[t._v("settings")]),t._v(" "),n("v-toolbar-title",[t._v("Настройки")]),t._v(" "),n("v-spacer"),t._v(" "),n("v-btn",{attrs:{icon:""},on:{click:function(e){t.dialog=!1}}},[n("v-icon",[t._v(" close")])],1)],1),t._v(" "),n("v-divider"),t._v(" "),n("v-card-text",{staticClass:"pa-0"},[n("v-form",{ref:"form"},[n("v-card-text",[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",[n("v-form",{ref:"form"},[n("v-container",{staticClass:"py-0"},[n("v-row",[n("v-subheader",[t._v("Основная информация")]),t._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{label:"Название",filled:"",rules:[function(t){return!!t||"Введите название"}],required:""},model:{value:t.m_name,callback:function(e){t.m_name="string"==typeof e?e.trim():e},expression:"m_name"}})],1),t._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-textarea",{attrs:{filled:"",label:"Описание",rules:[function(t){return!!t||"Введите описание"}],required:""},model:{value:t.m_description,callback:function(e){t.m_description="string"==typeof e?e.trim():e},expression:"m_description"}})],1),t._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-select",{attrs:{items:t.subjects,"item-text":"name","item-value":"id",height:"68",filled:"",label:"Категория",rules:[function(t){return!!t||"Выберите категорию"}],required:""},model:{value:t.m_subjectId,callback:function(e){t.m_subjectId=e},expression:"m_subjectId"}})],1)],1)],1)],1)],1),t._v(" "),n("v-divider",{staticClass:"mx-2",attrs:{vertical:""}}),t._v(" "),n("v-col",[n("v-container",{staticClass:"py-0"},[n("v-row",[n("v-subheader",[t._v("Настройки отображения")]),t._v(" "),n("v-col",{attrs:{cols:"12"}},[t.isAuth?n("v-select",{attrs:{height:"68",filled:"","hide-details":"",items:t.tiles,"item-text":"name","item-value":"id",label:"Выберите",rules:[function(t){return!!t||"Выберите подложку"}],required:""},scopedSlots:t._u([{key:"item",fn:function(e){var i=e.item;return[t._v("\n                                                "+t._s(i.name)+"\n                                                "),n("v-spacer"),t._v(" "),t.deletedTileId.find((function(t){return t===i.id}))?n("v-progress-circular",{attrs:{indeterminate:"",size:"24",width:"1",color:"primary"}}):i.id!==t.m_tileId?n("v-btn",{attrs:{icon:""},on:{click:function(e){return e.stopPropagation(),t.lDeleteTile(i.id)}}},[n("v-icon",[t._v("\n                                                        remove\n                                                    ")])],1):t._e()]}}],null,!1,2224105957),model:{value:t.m_tileId,callback:function(e){t.m_tileId=e},expression:"m_tileId"}}):n("v-select",{attrs:{height:"68",filled:"","hide-details":"",items:t.sharedTiles,"item-text":"name","item-value":"id",label:"Выберите",rules:[function(t){return!!t||"Выберите подложку"}],required:""},model:{value:t.m_tileId,callback:function(e){t.m_tileId=e},expression:"m_tileId"}}),t._v(" "),n("AddTileDialog")],1),t._v(" "),n("v-col",{staticClass:"pt-0",attrs:{cols:"12"}},[n("v-switch",{attrs:{label:"Отображение связывающих линий","hide-details":""},model:{value:t.m_showPolyline,callback:function(e){t.m_showPolyline=e},expression:"m_showPolyline"}})],1),t._v(" "),n("v-col",{attrs:{cols:"12"}},[n("v-slider",{attrs:{min:"1",max:"10",label:"Толщина связывающих линий","hide-details":""},model:{value:t.m_polylineWeight,callback:function(e){t.m_polylineWeight=e},expression:"m_polylineWeight"}})],1),t._v(" "),n("v-col",{staticClass:"pt-2",attrs:{cols:"12"}},[n("v-text-field",{attrs:{label:"Минимальный зум",filled:"",dense:"",type:"number",step:"1",rules:[function(t){return!!t||"Введите значение"},function(t){return t>=0||"Значение меньше ноля"},function(e){return e<=t.config.maxZoom||"Минимальный зум должен быть меньше максимального"}]},model:{value:t.m_minZoom,callback:function(e){t.m_minZoom="string"==typeof e?e.trim():e},expression:"m_minZoom"}})],1),t._v(" "),n("v-col",{staticClass:"pt-0",attrs:{cols:"12"}},[n("v-text-field",{attrs:{label:"Максимальный зум",filled:"",dense:"",type:"number",rules:[function(t){return!!t||"Введите значение"},function(t){return t>=0||"Значение меньше ноля"},function(e){return e>=t.config.minZoom||"Максимальный зум должен быть больше минимального"}]},model:{value:t.m_maxZoom,callback:function(e){t.m_maxZoom="string"==typeof e?e.trim():e},expression:"m_maxZoom"}})],1)],1)],1)],1)],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null),q=$.exports;p()($,{VBtn:f.a,VCard:m.a,VCardText:h.c,VCol:b.a,VContainer:_.a,VDialog:g.a,VDivider:y.a,VForm:x.a,VIcon:S.a,VProgressCircular:Z.a,VRow:V.a,VSelect:P.a,VSlider:B.a,VSpacer:D.a,VSubheader:k.a,VSwitch:G.a,VTextField:L.a,VTextarea:z.a,VToolbar:M.a,VToolbarTitle:A.a});var Y={name:"ControlPanelHelp",data:function(){return{dialog:!1}}},J=n(390),X=n(391),K=n(392),Q=Object(u.a)(Y,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-dialog",{attrs:{"max-width":"660",scrollable:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[i("v-btn",t._g({staticClass:"mx-2",attrs:{height:"40"}},n),[i("v-icon",{staticClass:"mr-1",staticStyle:{opacity:"0.76"}},[t._v("help_outline")]),t._v("\n            Помощь\n        ")],1)]}}]),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[t._v(" "),i("v-card",[i("v-toolbar",{staticClass:"pr-1",attrs:{height:"68",flat:""}},[i("v-icon",{staticClass:"mr-2",attrs:{large:""}},[t._v("help_outline")]),t._v(" "),i("v-toolbar-title",[t._v(" Помощь")]),t._v(" "),i("v-spacer"),t._v(" "),i("v-btn",{attrs:{icon:""},on:{click:function(e){t.dialog=!1}}},[i("v-icon",[t._v(" close ")])],1)],1),t._v(" "),i("v-divider"),t._v(" "),i("v-card-text",{staticClass:"pb-0"},[i("v-form",{ref:"form"},[i("v-container",{staticClass:"py-1"},[i("v-stepper",{staticClass:"elevation-0",attrs:{vertical:"","non-linear":""}},[i("v-stepper-step",{attrs:{editable:"",step:"1"}},[t._v("\n                            Установите подложку\n                            "),i("small",[t._v("Стандартную или пользовательскую")])]),t._v(" "),i("v-stepper-content",{attrs:{step:"1"}},[i("v-img",{staticClass:"mb-8",attrs:{contain:"","max-height":"100%",src:n(349)}})],1),t._v(" "),i("v-stepper-step",{attrs:{editable:"",step:"2"}},[t._v("Добавьте событие")]),t._v(" "),i("v-stepper-content",{attrs:{step:"2"}},[i("v-img",{staticClass:"mb-8",attrs:{contain:"","max-height":"100%",src:n(350)}})],1),t._v(" "),i("v-stepper-step",{attrs:{editable:"",step:"3"}},[t._v("Установите название и описание")]),t._v(" "),i("v-stepper-content",{attrs:{step:"3"}},[i("v-img",{staticClass:"mb-8",attrs:{contain:"","max-height":"100%",src:n(351)}})],1),t._v(" "),i("v-stepper-step",{attrs:{editable:"",step:"4"}},[t._v("Установите нужные медиа-обьекты к описываемому событию")]),t._v(" "),i("v-stepper-content",{attrs:{step:"4"}},[i("v-img",{staticClass:"mb-8",attrs:{"max-height":"100%",contain:"",src:n(352)}})],1),t._v(" "),i("v-stepper-step",{attrs:{editable:"",step:"5"}},[t._v("\n                            Установите метку на информационной карте\n                            "),i("small",[t._v("Иконки и размер меток можно изменять")])]),t._v(" "),i("v-stepper-content",{attrs:{step:"5"}},[i("v-img",{staticClass:"mb-8",attrs:{contain:"","max-height":"100%",src:n(353)}})],1),t._v(" "),i("v-stepper-step",{attrs:{editable:"",step:"6"}},[t._v("\n                            Сохранить и поделиться атласом\n                            "),i("small",[t._v("Разместить атлас на нужном веб-ресурсе")])]),t._v(" "),i("v-stepper-content",{attrs:{step:"6"}},[i("v-img",{staticClass:"mb-8",attrs:{contain:"","max-height":"100%",src:n(354)}})],1)],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null),tt=Q.exports;function et(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function nt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?et(Object(n),!0).forEach((function(e){it(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function it(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}p()(Q,{VBtn:f.a,VCard:m.a,VCardText:h.c,VContainer:_.a,VDialog:g.a,VDivider:y.a,VForm:x.a,VIcon:S.a,VImg:w.a,VSpacer:D.a,VStepper:J.a,VStepperContent:X.a,VStepperStep:K.a,VToolbar:M.a,VToolbarTitle:A.a});var rt={name:"ControlPanel",components:{Settings:q,Help:tt},data:function(){return{procSave:!1,waitUserAuth:!1,searchEventTitle:""}},computed:nt(nt(nt(nt(nt(nt(nt({},Object(o.c)("map",["wasChanges"])),Object(o.c)("auth",["isAuth"])),Object(o.e)("map",["id"])),Object(o.e)("layout",["authDialog"])),Object(o.e)("map",["events"])),Object(o.e)("tiles",["tiles"])),{},{mapIsExample:function(){return!this.$route.params.id}}),methods:nt(nt(nt(nt({},Object(o.b)("map",["saveMap","recoveryMap"])),Object(o.d)("layout",["SHOW_AUTH_DIALOG"])),Object(o.d)("map",["SET_SELECTED_EVENT_ID"])),{},{save:function(){var t=this;this.isAuth?(this.procSave=!0,this.saveMap().finally((function(){return t.procSave=!1}))):(this.SHOW_AUTH_DIALOG(),this.waitUserAuth=!0)},findAndSelectEventByTitle:function(){var t=this,e=this.events.find((function(e){return e.title.toUpperCase()===t.searchEventTitle.toUpperCase()}));e||(e=this.events.find((function(e){return e.title.toUpperCase().includes(t.searchEventTitle.toUpperCase())}))),e&&this.SET_SELECTED_EVENT_ID(e.id)}}),watch:{authDialog:function(t,e){var n=this;e&&!t&&this.waitUserAuth&&this.isAuth?(this.procSave=!0,this.saveMap().finally((function(){n.procSave=!1,n.waitUserAuth=!1}))):e&&!t&&this.waitUserAuth&&(this.waitUserAuth=!1)}}},at=n(86),ot=Object(u.a)(rt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex"},[t.mapIsExample?n("v-btn",{staticClass:"mr-2 primary--text",attrs:{to:"/",height:"40"}},[n("v-icon",{staticClass:"mr-1"},[t._v(" home")]),t._v("\n        Главная\n    ")],1):n("v-btn",{staticClass:"mr-2",attrs:{to:"/library",height:"40"}},[n("v-icon",{staticClass:"mr-1",attrs:{color:"primary"}},[t._v(" arrow_back_ios")]),t._v("\n        Моя библиотека\n    ")],1),t._v(" "),n("v-btn",{staticClass:"mx-2",attrs:{height:"40"},on:{click:function(e){return t.save()}}},[n("v-icon",{staticClass:"mr-1",class:{"primary--text":t.wasChanges},style:t.wasChanges?"":"opacity: 0.76"},[t._v("\n            save\n        ")]),t._v("\n        Сохранить\n    ")],1),t._v(" "),n("v-dialog",{attrs:{"overlay-opacity":"0",persistent:"",width:"300"},model:{value:t.procSave,callback:function(e){t.procSave=e},expression:"procSave"}},[n("v-card",{attrs:{color:"primary",dark:""}},[n("v-card-text",{staticClass:"pt-3"},[t._v("\n                Сохранение\n                "),n("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1),t._v(" "),n("v-btn",{staticClass:"mx-2",attrs:{height:"40"},on:{click:function(e){return t.recoveryMap()}}},[n("v-icon",{staticClass:"mr-1",staticStyle:{opacity:"0.76"}},[t._v("\n            restore\n        ")]),t._v("\n        Восстановить\n    ")],1),t._v(" "),n("Settings"),t._v(" "),n("Help"),t._v(" "),n("v-text-field",{staticClass:"mx-4",attrs:{dense:"","single-line":"",rounded:"",filled:"",clearable:"","hide-details":"","prepend-inner-icon":"search",label:"Поиск события..."},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.findAndSelectEventByTitle(e)}},model:{value:t.searchEventTitle,callback:function(e){t.searchEventTitle=e},expression:"searchEventTitle"}}),t._v(" "),n("v-btn",{staticClass:"ml-2",attrs:{height:"40"},on:{click:function(e){t.mapIsExample?t.$router.push("/viewer"):t.$router.push({path:"/viewer/"+t.id})}}},[n("v-icon",{staticClass:"mr-1",attrs:{color:"primary"}},[t._v("pageview")]),t._v("\n        Предпросмотр\n    ")],1)],1)}),[],!1,null,null,null),st=ot.exports;p()(ot,{VBtn:f.a,VCard:m.a,VCardText:h.c,VDialog:g.a,VIcon:S.a,VProgressLinear:at.a,VTextField:L.a});var lt=n(357);function ct(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function dt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ct(Object(n),!0).forEach((function(e){ut(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ct(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ut(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var vt={name:"ConstructorEventList",components:{EventList:lt.SlickList,EventItem:lt.SlickItem},data:function(){return{showButtonDeleteEvent:null}},computed:dt(dt({},Object(o.e)("map",["config","events"])),{},{model_events:{get:function(){return this.events},set:function(t){this.SET_EVENTS(t)}}}),methods:dt(dt(dt({},Object(o.d)("map",["SET_EVENTS","SET_SELECTED_EVENT_ID","DELETE_EVENT_BY_INDEX"])),Object(o.b)("map",["deleteEventByIndex","addEvent"])),{},{addEventLocal:function(){this.addEvent().then((function(t){var e=document.getElementById("eventList");e.scrollTop=e.scrollHeight}))}})},pt=(n(358),Object(u.a)(vt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("EventList",{staticClass:"d-flex flex-column pr-2",style:{width:t.config.eventListWidth+"px"},attrs:{id:"eventList",lockAxis:"y",appendTo:"div#eventList",lockToContainerEdges:"",distance:3,lockOffset:"20%",helperClass:"eventDraggable"},model:{value:t.model_events,callback:function(e){t.model_events=e},expression:"model_events"}},[t._l(t.events,(function(e,i){return n("EventItem",{key:e.id,staticClass:"d-flex mb-1",staticStyle:{position:"relative",cursor:"pointer"},attrs:{index:i}},[n("v-icon",{directives:[{name:"show",rawName:"v-show",value:1!==t.events.length,expression:"events.length !== 1"}],class:{"d-none":t.showButtonDeleteEvent!==i},staticStyle:{position:"absolute",right:"2px",top:"2px","z-index":"4"},on:{mouseover:function(e){t.showButtonDeleteEvent=i},mouseleave:function(e){t.showButtonDeleteEvent=null},click:function(e){return e.stopPropagation(),t.deleteEventByIndex(i)}}},[t._v("\n            close\n        ")]),t._v(" "),n("div",{staticClass:"v-btn v-btn--block v-btn--depressed v-size--x-large text-wrap",class:[{"v-btn--text primary--text v-btn--active":t.config.selectedEventId===e.id},t.$vuetify.theme.dark?"theme--dark":"theme--light"],staticStyle:{"margin-bottom":"2px",border:"1px solid","min-height":"80px","max-width":"100%"},style:t.config.selectedEventId===e.id?"border-color: #1976d2":"border-color: rgba(0, 0, 0, 0.24)",on:{mouseover:function(e){t.showButtonDeleteEvent=i},mouseleave:function(e){t.showButtonDeleteEvent=null},click:function(n){return t.SET_SELECTED_EVENT_ID(e.id)}}},[n("span",{staticClass:"v-btn__content"},[t._v("\n                "+t._s(e.title)+"\n            ")])])],1)})),t._v(" "),n("v-btn",{staticClass:"mx-auto",staticStyle:{color:"rgba(0, 0, 0, 0.74)"},attrs:{"x-large":"",depressed:"",icon:""},on:{click:function(e){return t.addEventLocal()}}},[n("v-icon",[t._v("add")])],1)],2)}),[],!1,null,"7dcb135a",null)),ft=pt.exports;p()(pt,{VBtn:f.a,VIcon:S.a});var mt=n(2),ht=n.n(mt),bt=n(50),_t=n(313),gt=(n(366),n(306));function yt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Et(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?yt(Object(n),!0).forEach((function(e){Ot(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ot(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var xt={name:"EventFormAddMediaDialog",data:function(){return{processing:!1,addMediaDialog:!1,mediaUrl:"",mediaFile:null}},computed:Et({},Object(o.c)("map",["indexSelectedEvent"])),methods:Et(Et(Et({},Object(o.d)("map",["ADD_EVENT_MEDIA_URL"])),Object(o.b)("map",["addMedia"])),{},{addMediaResource:function(){var t=this;this.mediaFile?(this.processing=!0,this.addMedia(this.mediaFile).then((function(e){t.addMediaDialog=!1,t.mediaFile=null})).finally((function(){t.processing=!1}))):this.mediaUrl&&(this.ADD_EVENT_MEDIA_URL({index:this.indexSelectedEvent,mediaUrl:this.mediaUrl}),this.addMediaDialog=!1,this.mediaUrl="")}})},Tt=Object(u.a)(xt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-dialog",{attrs:{persistent:t.processing,"max-width":"380"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[n("v-btn",t._g({staticClass:"mb-4 primary--text",staticStyle:{"flex-grow":"0"},attrs:{block:"",large:""}},i),[n("v-icon",{staticClass:"mr-2"},[t._v("insert_photo")]),t._v("\n            Добавить медиа\n        ")],1)]}}]),model:{value:t.addMediaDialog,callback:function(e){t.addMediaDialog=e},expression:"addMediaDialog"}},[t._v(" "),n("v-card",[n("v-toolbar",{staticClass:"pr-1",attrs:{height:"68",flat:""}},[n("v-toolbar-title",[n("v-icon",{staticClass:"mr-1 pb-1",attrs:{large:""}},[t._v("insert_photo")]),t._v("\n                Добавление медиа\n            ")],1)],1),t._v(" "),n("v-card-text",{staticClass:"pb-0"},[n("v-text-field",{attrs:{disabled:null!==t.mediaFile,clearable:"",label:"Ссылка на картинку или YouTube"},model:{value:t.mediaUrl,callback:function(e){t.mediaUrl="string"==typeof e?e.trim():e},expression:"mediaUrl"}}),t._v("\n            или\n            "),n("v-file-input",{attrs:{disabled:""!==t.mediaUrl,label:"Загрузка файла с компьютера",accept:"image/*, video/*","prepend-icon":"attach_file"},model:{value:t.mediaFile,callback:function(e){t.mediaFile=e},expression:"mediaFile"}})],1),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{loading:t.processing,color:"primary",text:"",disabled:""===t.mediaUrl&&null===t.mediaFile},on:{click:function(e){return t.addMediaResource()}}},[t._v("\n                Добавить\n            ")])],1)],1)],1)}),[],!1,null,null,null),St=Tt.exports;function wt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Ct(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?wt(Object(n),!0).forEach((function(e){jt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):wt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function jt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}p()(Tt,{VBtn:f.a,VCard:m.a,VCardActions:h.a,VCardText:h.c,VDialog:g.a,VFileInput:O.a,VIcon:S.a,VSpacer:D.a,VTextField:L.a,VToolbar:M.a,VToolbarTitle:A.a}),ht.a.use(_t.q,{vuetify:bt.a,iconsGroup:"md"});var It={name:"ConstructorForm",components:{EventFormAddMediaDialog:St,MediaContent:gt.a,TiptapVuetify:_t.p},data:function(){return{changeIconDialog:!1,iconUrl:"",iconWidth:null,iconHeight:null,extensions:[_t.h,_t.k,[_t.g,{options:{levels:[1,2,3,4]}}],_t.r,_t.o,_t.j,_t.b,_t.l,_t.c,_t.m,_t.a,_t.i,_t.n,_t.f,_t.d,_t.e]}},watch:{changeIconDialog:function(t){t&&(this.iconUrl=this.selectedEvent.marker.url,this.iconWidth=this.selectedEvent.marker.size[0],this.iconHeight=this.selectedEvent.marker.size[1])}},computed:Ct(Ct({},Object(o.c)("map",["selectedEvent","indexSelectedEvent"])),{},{model_title:{get:function(){return this.selectedEvent.title},set:function(t){var e={index:this.indexSelectedEvent,title:t};this.SET_EVENT_TITLE(e)}},model_description:{get:function(){return this.selectedEvent.description},set:function(t){var e={index:this.indexSelectedEvent,description:t};this.SET_EVENT_DESCRIPTION(e)}},model_mediaUrl:{get:function(){return this.selectedEvent.mediaUrl},set:function(t){var e={index:this.indexSelectedEvent,mediaUrl:t};this.SET_EVENT_MEDIA_URL(e)}}}),methods:Ct({},Object(o.d)("map",["SET_EVENT_TITLE","SET_EVENT_DESCRIPTION","SET_ICON_FOR_EVENT","SET_ICON_FOR_ALL_EVENTS"]))},Vt=(n(370),Object(u.a)(It,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-row",{staticClass:"mt-3",staticStyle:{"max-height":"36vh","min-height":"36vh"},attrs:{"no-gutters":""}},[n("v-col",{staticClass:"pr-1 d-flex flex-column",staticStyle:{"max-height":"100%",overflow:"auto"},attrs:{cols:"6"}},[n("v-text-field",{staticClass:"border-color-gray",staticStyle:{"flex-grow":"0"},attrs:{label:"Название события...","single-line":"",outlined:"","hide-details":"",clearable:""},model:{value:t.model_title,callback:function(e){t.model_title="string"==typeof e?e.trim():e},expression:"model_title"}}),t._v(" "),n("tiptap-vuetify",{staticClass:"d-flex flex-grow-1 mt-3",attrs:{extensions:t.extensions,"card-props":{outlined:!0,style:"width: 100%"},placeholder:"Описание события..."},model:{value:t.model_description,callback:function(e){t.model_description=e},expression:"model_description"}})],1),t._v(" "),n("v-col",{staticClass:"d-flex flex-column pl-2",staticStyle:{"max-height":"100%"},attrs:{cols:"6"}},[n("v-card",{staticClass:"d-flex flex-column",attrs:{height:"100%",outlined:""}},[n("v-card-title",{staticStyle:{"font-size":"1rem !important"}},[n("v-icon",{staticClass:"mr-2"},[t._v("perm_media")]),t._v("\n                Медиа-содержимое\n            ")],1),t._v(" "),n("v-divider"),t._v(" "),n("v-card-text",{staticClass:"d-flex flex",staticStyle:{"max-height":"100%",overflow:"auto"}},[n("v-col",{staticClass:"d-flex flex-column justify-center",attrs:{cols:"6"}},[n("EventFormAddMediaDialog"),t._v(" "),n("v-btn",{staticStyle:{"flex-grow":"0"},attrs:{block:"",large:""},on:{click:function(e){t.changeIconDialog=!0}}},[n("v-img",{staticClass:"mr-2",attrs:{"max-height":"32","max-width":"32",contain:"",src:t.selectedEvent.marker.url}}),t._v("\n                        Изменить иконку\n                    ")],1),t._v(" "),n("v-dialog",{attrs:{"max-width":"320"},model:{value:t.changeIconDialog,callback:function(e){t.changeIconDialog=e},expression:"changeIconDialog"}},[n("v-card",[n("v-toolbar",{staticClass:"pr-1",attrs:{height:"68",flat:""}},[n("v-toolbar-title",[n("v-icon",{staticClass:"mr-1 pb-1",attrs:{large:""}},[t._v("location_on")]),t._v("\n                                    Изменение иконки\n                                ")],1)],1),t._v(" "),n("v-card-text",{staticClass:"pb-0"},[n("v-text-field",{attrs:{label:"Ссылка на иконку"},model:{value:t.iconUrl,callback:function(e){t.iconUrl=e},expression:"iconUrl"}}),t._v(" "),n("v-row",[n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{label:"Ширина"},model:{value:t.iconWidth,callback:function(e){t.iconWidth=e},expression:"iconWidth"}})],1),t._v(" "),n("v-col",{attrs:{cols:"6"}},[n("v-text-field",{attrs:{label:"Высота"},model:{value:t.iconHeight,callback:function(e){t.iconHeight=e},expression:"iconHeight"}})],1)],1)],1),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("div",{staticClass:"d-flex flex-column align-end"},[n("v-btn",{staticClass:"my-1",attrs:{text:""},on:{click:function(e){t.changeIconDialog=!1,t.SET_ICON_FOR_ALL_EVENTS({index:t.indexSelectedEvent,iconUrl:t.iconUrl,size:[t.iconWidth,t.iconHeight]})}}},[t._v("\n                                        Применить ко всем\n                                    ")]),t._v(" "),n("v-btn",{staticClass:"flex-grow-0 my-1",attrs:{color:"primary",text:""},on:{click:function(e){t.changeIconDialog=!1,t.SET_ICON_FOR_EVENT({index:t.indexSelectedEvent,iconUrl:t.iconUrl,size:[t.iconWidth,t.iconHeight]})}}},[t._v("\n                                        Применить\n                                    ")])],1)],1)],1)],1)],1),t._v(" "),n("v-col",{staticClass:"d-flex flex-column justify-center",staticStyle:{"max-height":"100%",overflow:"auto"},attrs:{cols:"6"}},[n("MediaContent",{attrs:{height:"100%"}})],1)],1)],1)],1)],1)}),[],!1,null,"2c2ff232",null)),Pt=Vt.exports;p()(Vt,{VBtn:f.a,VCard:m.a,VCardActions:h.a,VCardText:h.c,VCardTitle:h.d,VCol:b.a,VDialog:g.a,VDivider:y.a,VIcon:S.a,VImg:w.a,VRow:V.a,VSpacer:D.a,VTextField:L.a,VToolbar:M.a,VToolbarTitle:A.a});var Dt=n(397),kt=n(398),Lt=n(399),Mt=n(400),At=n(401),Nt=n(402),Ut=n(403),Rt=n(404),Ft=(n(318),n(286));function Wt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Ht(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Wt(Object(n),!0).forEach((function(e){Zt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Wt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Zt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Bt={name:"Map",components:{LMap:Dt.a,LTileLayer:kt.a,LMarker:Lt.a,LTooltip:Mt.a,LIcon:At.a,LPolyline:Nt.a,LControlZoom:Ut.a,LImageOverlay:Rt.a},data:function(){return{maxBoundsViscosity:.9,polylineOpacity:.6,polylineDashArray:"6"}},watch:{"config.selectedEventId":function(){this.SET_TILE_CENTER(this.selectedEvent.marker.position)}},computed:Ht(Ht(Ht(Ht({},Object(o.e)("map",["config","events","tileCenter"])),Object(o.c)("map",["selectedEvent","indexSelectedEvent","arrayMarker"])),Object(o.c)("tiles",{tile:"selectedTile"})),{},{sync_center:{get:function(){return this.tileCenter},set:function(t){this.SET_TILE_CENTER(t)}},notGeomap:function(){return-1===this.tile.url.indexOf("{z}")&&-1===this.tile.url.indexOf("{x}")||-1===this.tile.url.indexOf("{y}")},crs:function(){return this.notGeomap?Ft.CRS.Simple:Ft.CRS.EPSG3857}}),methods:Ht(Ht(Ht({},Object(o.d)("map",["SET_TILE_CENTER","SET_SELECTED_EVENT_ID","SET_EVENT_MARKER_POSITION","SET_MIN_TILE_ZOOM","SET_MAX_TILE_ZOOM"])),Object(o.d)("tiles",["SET_TILE_BOUNDS"])),{},{latLngDragUpdatePosition:function(t){var e={index:this.indexSelectedEvent,position:t};this.SET_EVENT_MARKER_POSITION(e),this.SET_TILE_CENTER(this.selectedEvent.marker.position)},latLngClickUpdatePosition:function(t){this.$refs.map.mapObject.setView(this.selectedEvent.marker.position);var e={index:this.indexSelectedEvent,position:t.latlng};this.SET_EVENT_MARKER_POSITION(e)}})},Gt=(n(377),Object(u.a)(Bt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return void 0===t.tile?n("div",{staticClass:"d-flex justify-center align-center",staticStyle:{width:"100%",height:"100%","background-color":"rgba(204, 204, 204, 0.5)"}},[n("v-icon",{attrs:{large:""}},[t._v("layers")])],1):n("l-map",{ref:"map",staticClass:"map",staticStyle:{"z-index":"0"},attrs:{crs:t.crs,minZoom:t.notGeomap?t.config.minZoom-1:t.config.minZoom,maxZoom:t.config.maxZoom,center:t.sync_center,options:{zoomControl:!1}},on:{"update:center":function(e){t.sync_center=e},click:t.latLngClickUpdatePosition}},[t.notGeomap?n("l-image-overlay",{attrs:{bounds:t.tile.bounds,url:t.tile.url}}):n("l-tile-layer",{attrs:{url:t.tile.url,noWrap:"",attribution:t.tile.attribution}}),t._v(" "),t._l(t.events,(function(e,i){return n("l-marker",{key:e.id,attrs:{"lat-lng":e.marker.position,draggable:t.indexSelectedEvent===i},on:{click:function(n){return t.SET_SELECTED_EVENT_ID(e.id)},"update:latLng":t.latLngDragUpdatePosition}},[n("l-tooltip",[t._v("\n            "+t._s(e.title)+"\n        ")]),t._v(" "),t.indexSelectedEvent!==i?n("l-icon",{attrs:{"icon-size":e.marker.size,"icon-url":t.events[i].marker.url}}):n("l-icon",{attrs:{"icon-size":[1.4*e.marker.size[0],1.4*e.marker.size[1]],"icon-url":t.events[i].marker.url}})],1)})),t._v(" "),t.config.showPolyline?[n("l-polyline",{attrs:{"lat-lngs":t.arrayMarker,opacity:t.polylineOpacity,dashArray:t.polylineDashArray,weight:void 0!==t.config.polylineWeight?t.config.polylineWeight:2}})]:t._e(),t._v(" "),n("l-control-zoom",{attrs:{position:"topright"}})],2)}),[],!1,null,"54dca508",null)),zt=Gt.exports;function $t(t,e,n,i,r,a,o){try{var s=t[a](o),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(i,r)}function qt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Yt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}p()(Gt,{VIcon:S.a});var Jt={name:"Constructor",components:{ControlPanel:st,EventList:ft,EventForm:Pt,Map:zt},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?qt(Object(n),!0).forEach((function(e){Yt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(o.c)("map",["wasChanges"])),methods:{preventNav:function(t){this.wasChanges&&(t.preventDefault(),t.returnValue="")}},beforeRouteEnter:function(t,e,n){return(i=r.a.mark((function i(){return r.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!t.params.id){i.next=8;break}if("viewer"===e.name||t.params.id===e.params.id){i.next=4;break}return i.next=4,a.a.dispatch("map/getMap",t.params.id,{root:!0});case 4:document.title=a.a.state.map.name+" - MapDesigner",document.description=a.a.state.map.description,i.next=13;break;case 8:if("viewer"===e.name){i.next=11;break}return i.next=11,a.a.dispatch("map/setEmptyExampleMap",null,{root:!0});case 11:document.title="Пробное использование конструктора карт и атласов - MapDesigner",document.description="Попробуйте возможности для онлайн создания карт и электронных атласов в конструкторе MapDesigner бесплатно.";case 13:n((function(e){t.params.id&&window.addEventListener("beforeunload",e.preventNav)}));case 14:case"end":return i.stop()}}),i)})),function(){var t=this,e=arguments;return new Promise((function(n,r){var a=i.apply(t,e);function o(t){$t(a,n,r,o,s,"next",t)}function s(t){$t(a,n,r,o,s,"throw",t)}o(void 0)}))})();var i},beforeRouteLeave:function(t,e,n){this.wasChanges&&e.params.id&&"viewer"!==t.name&&!window.confirm("Изменения атласа не будут сохранены. Продолжить?")?n(!1):(window.removeEventListener("beforeunload",this.preventNav),n())}},Xt=Object(u.a)(Jt,(function(){var t=this.$createElement,e=this._self._c||t;return e("v-container",{staticClass:"d-flex flex-column",staticStyle:{height:"100vh"},attrs:{fluid:""}},[e("ControlPanel"),this._v(" "),e("v-divider",{staticClass:"my-3",staticStyle:{"border-style":"dashed"}}),this._v(" "),e("div",{staticClass:"d-flex flex overflow-hidden"},[e("EventList"),this._v(" "),e("div",{staticClass:"d-flex flex-column",staticStyle:{flex:"1","min-width":"200px","padding-left":"12px"}},[e("Map"),this._v(" "),e("EventForm")],1)],1)],1)}),[],!1,null,null,null);e.default=Xt.exports;p()(Xt,{VContainer:_.a,VDivider:y.a})}}]);