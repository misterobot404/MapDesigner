(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{289:function(e,t,n){var r=n(304);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(6)(r,i);r.locals&&(e.exports=r.locals)},303:function(e,t,n){"use strict";n(289)},304:function(e,t,n){(e.exports=n(5)(!1)).push([e.i,"[data-v-6b7cf79f] .youtube iframe {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  left: 0;\n  top: 0;\n}",""])},306:function(e,t,n){"use strict";var r=n(2),i=n.n(r),o=n(316),a=n(9);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}i.a.use(o.a);var u={name:"MediaContent",props:{height:{type:String,required:!0}},data:function(){return{imgNotExist:[],videoPlaying:!1}},computed:c({},Object(a.c)("map",["selectedEvent","indexSelectedEvent"])),methods:c({},Object(a.b)("map",{deleteMedia:"deleteMedia"}))},d=(n(303),n(12)),p=n(13),v=n.n(p),f=n(53),m=n(395),h=n(396),b=n(66),y=n(70),g=n(275),E=n(18),x=Object(d.a)(u,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-carousel",{attrs:{cycle:!e.videoPlaying,height:e.height,"show-arrows":e.selectedEvent.mediaUrl.length>1,"hide-delimiter-background":"","hide-delimiters":""}},[0!==e.selectedEvent.mediaUrl.length?e._l(e.selectedEvent.mediaUrl,(function(t,r){return n("v-carousel-item",{key:r},["constructor"===e.$route.name?n("v-btn",{staticClass:"v-btn--active",staticStyle:{right:"18px",top:"16px"},attrs:{fab:"","x-small":"",depressed:"",absolute:"",color:"grey"},on:{click:function(t){return e.deleteMedia({indexEvent:e.indexSelectedEvent,indexMediaUrl:r})}}},[n("v-icon",{attrs:{dark:""}},[e._v("clear")])],1):e._e(),e._v(" "),e.imgNotExist.includes(t)?t.indexOf("www.youtube.com")>-1?[n("youtube",{staticClass:"youtube",attrs:{"video-id":e.$youtube.getIdFromURL(t)},on:{playing:function(t){e.videoPlaying=!0},paused:function(t){e.videoPlaying=!1},ended:function(t){e.videoPlaying=!1}}})]:[n("div",{staticClass:"d-flex align-center fill-height"},[n("video",{attrs:{controls:"",width:"100%"},on:{play:function(t){e.videoPlaying=!0},pause:function(t){e.videoPlaying=!1}}},[n("source",{attrs:{src:t,type:"video/mp4"}})])])]:[n("v-img",{attrs:{height:"100%",contain:"",src:t},on:{error:function(n){return e.imgNotExist.push(t)}}})]],2)})):n("v-carousel-item",[n("v-sheet",{attrs:{color:"primary",height:"100%"}},[n("v-row",{staticClass:"fill-height",attrs:{align:"center",justify:"center"}},[n("div",{staticClass:"display-1"},[e._v("Контент")])])],1)],1)],2)}),[],!1,null,"6b7cf79f",null);t.a=x.exports;v()(x,{VBtn:f.a,VCarousel:m.a,VCarouselItem:h.a,VIcon:b.a,VImg:y.a,VRow:g.a,VSheet:E.a})},320:function(e,t,n){var r=n(380);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(6)(r,i);r.locals&&(e.exports=r.locals)},379:function(e,t,n){"use strict";n(320)},380:function(e,t,n){(e.exports=n(5)(!1)).push([e.i,".map[data-v-58a08b97] {\n  width: 100%;\n  margin: auto;\n  border: 1px solid #4d565661;\n}",""])},408:function(e,t,n){"use strict";n.r(t);var r=n(30),i=n.n(r),o=n(27),a=n(9),s=n(397),c=n(398),l=n(399),u=n(400),d=n(401),p=n(402),v=n(404),f=(n(318),n(286));function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y={name:"Map",components:{LMap:s.a,LTileLayer:c.a,LMarker:l.a,LTooltip:u.a,LIcon:d.a,LPolyline:p.a,LImageOverlay:v.a},data:function(){return{maxBoundsViscosity:.9,polylineOpacity:.6,polylineDashArray:"6"}},watch:{"config.selectedEventId":function(){this.$refs.map.mapObject.flyTo(this.selectedEvent.marker.position)}},computed:h(h(h(h({},Object(a.e)("map",["config","events","tileCenter"])),Object(a.c)("map",["selectedEvent","indexSelectedEvent","arrayMarker"])),Object(a.c)("tiles",{tile:"selectedTile"})),{},{sync_center:{get:function(){return this.tileCenter},set:function(e){this.SET_TILE_CENTER(e)}},noIframe:function(){return window===window.parent},notGeomap:function(){return-1===this.tile.url.indexOf("{z}")&&-1===this.tile.url.indexOf("{x}")||-1===this.tile.url.indexOf("{y}")},crs:function(){return this.notGeomap?f.CRS.Simple:f.CRS.EPSG3857}}),methods:h(h({},Object(a.d)("map",["SET_TILE_CENTER","SET_SELECTED_EVENT_ID","SET_EVENT_MARKER_POSITION","SET_MIN_TILE_ZOOM","SET_MAX_TILE_ZOOM"])),{},{prevEvent:function(){0===this.indexSelectedEvent?this.SET_SELECTED_EVENT_ID(this.events[this.events.length-1].id):0!==this.indexSelectedEvent&&this.SET_SELECTED_EVENT_ID(this.events[this.indexSelectedEvent-1].id)},nextEvent:function(){this.indexSelectedEvent===this.events.length-1?this.SET_SELECTED_EVENT_ID(this.events[0].id):this.indexSelectedEvent!==this.events.length-1&&this.SET_SELECTED_EVENT_ID(this.events[this.indexSelectedEvent+1].id)},keyDownEvent:function(e){37===e.keyCode?this.prevEvent():39===e.keyCode&&this.nextEvent()}}),beforeMount:function(){var e=this;window.addEventListener("keydown",(function(t){return e.keyDownEvent(t)}))},beforeDestroy:function(){var e=this;window.removeEventListener("keydown",(function(t){return e.keyDownEvent(t)}))}},g=(n(379),n(12)),E=n(13),x=n.n(E),_=n(53),w=n(66),O=n(54),S=n(330),j=Object(g.a)(y,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return void 0===e.tile?n("div",{staticClass:"d-flex justify-center align-center",staticStyle:{width:"100%",height:"100%"}},[n("v-progress-circular",{attrs:{indeterminate:"",color:"primary",width:"2"}})],1):n("l-map",{ref:"map",staticClass:"map",attrs:{crs:e.crs,minZoom:e.notGeomap?e.config.minZoom-1:e.config.minZoom,maxZoom:e.config.maxZoom,center:e.sync_center,options:{zoomControl:!1}},on:{"update:center":function(t){e.sync_center=t}}},[e.notGeomap?n("l-image-overlay",{attrs:{bounds:e.tile.bounds,url:e.tile.url}}):n("l-tile-layer",{attrs:{url:e.tile.url,noWrap:"",attribution:e.tile.attribution}}),e._v(" "),e._l(e.events,(function(t,r){return n("l-marker",{key:t.id,attrs:{"lat-lng":t.marker.position},on:{click:function(n){return e.SET_SELECTED_EVENT_ID(t.id)}}},[n("l-tooltip",[e._v("\n            "+e._s(t.title)+"\n        ")]),e._v(" "),e.indexSelectedEvent!==r?n("l-icon",{attrs:{"icon-size":t.marker.size,"icon-url":e.events[r].marker.url}}):n("l-icon",{attrs:{"icon-size":[1.4*t.marker.size[0],1.4*t.marker.size[1]],"icon-url":e.events[r].marker.url}})],1)})),e._v(" "),e.config.showPolyline?[n("l-polyline",{attrs:{"lat-lngs":e.arrayMarker,opacity:e.polylineOpacity,dashArray:e.polylineDashArray,weight:void 0!==e.config.polylineWeight?e.config.polylineWeight:2}})]:e._e(),e._v(" "),n("v-btn",{staticClass:"v-btn--active",staticStyle:{bottom:"50%",left:"16px","z-index":"401"},attrs:{fab:"",dark:"",text:"","x-large":"",absolute:"",color:"primary"},on:{dblclick:function(e){e.stopPropagation()},click:e.prevEvent}},[n("v-icon",{attrs:{"x-large":""}},[e._v("keyboard_arrow_left")])],1),e._v(" "),n("v-btn",{staticClass:"v-btn--active",staticStyle:{bottom:"50%",right:"16px","z-index":"401"},attrs:{fab:"",dark:"",absolute:"","x-large":"",text:"",color:"primary"},on:{dblclick:function(e){e.stopPropagation()},click:e.nextEvent}},[n("v-icon",{attrs:{"x-large":""}},[e._v("keyboard_arrow_right")])],1),e._v(" "),n("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[e.noIframe?n("v-btn",e._g({staticClass:"v-btn--active",staticStyle:{top:"16px",left:"16px","z-index":"401"},attrs:{absolute:"",text:"",rounded:"","x-large":""},on:{click:function(t){return t.stopPropagation(),e.$router.back()}}},r),[n("v-icon",{attrs:{large:""}},[e._v("first_page")])],1):e._e()]}}])},[e._v(" "),n("span",[e._v("Назад")])])],2)}),[],!1,null,"58a08b97",null),k=j.exports;function C(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){D(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}x()(j,{VBtn:_.a,VIcon:w.a,VProgressCircular:O.a,VTooltip:S.a});var L={name:"Viewer",components:{Map:k,MediaContent:n(306).a},computed:T(T({},Object(a.c)("map",["selectedEvent","wasChanges"])),{},{pageUsedFromDesktop:function(){return this.$vuetify.breakpoint.mdAndUp}}),methods:T(T({},Object(a.d)("map",["SET_SELECTED_EVENT_ID","SET_TILE_CENTER"])),{},{preventNav:function(e){this.wasChanges&&(e.preventDefault(),e.returnValue="")}}),beforeRouteEnter:function(e,t,n){return(r=i.a.mark((function r(){return i.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!e.params.id){r.next=9;break}if("constructor"===t.name||e.params.id===t.params.id){r.next=5;break}return o.a.getters["auth/isAuth"]&&o.a.dispatch("tiles/getTiles",null,{root:!0}),r.next=5,o.a.dispatch("map/getMap",e.params.id,{root:!0});case 5:document.title=o.a.state.map.name+" - MapDesigner",document.description=o.a.state.map.description,r.next=14;break;case 9:if("test"===o.a.state.map.id){r.next=12;break}return r.next=12,o.a.dispatch("map/setEmptyExampleMap",null,{root:!0});case 12:document.title="Пробное использование конструктора карт и атласов - MapDesigner",document.description="Попробуйте возможности для онлайн создания карт и электронных атласов в конструкторе MapDesigner бесплатно.";case 14:n((function(t){"example"!==e.name&&e.params.id&&window.addEventListener("beforeunload",t.preventNav)}));case 15:case"end":return r.stop()}}),r)})),function(){var e=this,t=arguments;return new Promise((function(n,i){var o=r.apply(e,t);function a(e){C(o,n,i,a,s,"next",e)}function s(e){C(o,n,i,a,s,"throw",e)}a(void 0)}))})();var r},beforeRouteLeave:function(e,t,n){"example"!==t.name&&this.wasChanges&&t.params.id&&"constructor"!==e.name&&!window.confirm("Изменения атласа не будут сохранены. Продолжить?")?n(!1):(window.removeEventListener("beforeunload",this.preventNav),n())}},M=Object(g.a)(L,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{position:"relative",overflow:"hidden",width:"100%",height:"100vh"}},[n("Map",{staticStyle:{position:"absolute","z-index":"0"}}),e._v(" "),e.pageUsedFromDesktop?n("div",{staticClass:"d-flex flex-column justify-center",staticStyle:{position:"absolute",right:"100px",height:"100vh",width:"34vw","z-index":"1","pointer-events":"none"}},[n("div",{staticClass:"pa-4 d-flex flex-column text-center rounded",staticStyle:{"max-height":"90vh","background-color":"rgba(225, 225, 225, 0.8)","pointer-events":"all",overflow:"hidden"}},[e.selectedEvent.mediaUrl.length>0?n("MediaContent",{staticStyle:{"flex-shrink":"0"},attrs:{height:"38vh"}}):e._e(),e._v(" "),n("div",{staticClass:"display-1 mx-6 mt-6"},[e._v(e._s(e.selectedEvent.title))]),e._v(" "),n("div",{staticClass:"mx-6 mt-4",staticStyle:{"overflow-y":"auto"},domProps:{innerHTML:e._s(e.selectedEvent.description)}})],1)]):n("div",{staticClass:"d-flex flex-row justify-center",staticStyle:{position:"absolute",bottom:"20px","max-height":"40vh",width:"100vw","z-index":"1","pointer-events":"none"}},[n("div",{staticClass:"pa-4 d-flex flex-column align-center text-center rounded",staticStyle:{"max-width":"94vw","background-color":"rgba(225, 225, 225, 0.8)","pointer-events":"all","overflow-y":"auto"}},[n("div",{staticClass:"headline mt-3"},[e._v(e._s(e.selectedEvent.title))]),e._v(" "),e.selectedEvent.mediaUrl.length>0?n("MediaContent",{staticClass:"mt-3",staticStyle:{"flex-shrink":"0","max-width":"42vh"},attrs:{height:"28vh"}}):e._e(),e._v(" "),n("div",{staticClass:"mx-2 mt-3",domProps:{innerHTML:e._s(e.selectedEvent.description)}})],1)])],1)}),[],!1,null,null,null);t.default=M.exports}}]);